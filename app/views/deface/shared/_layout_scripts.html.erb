<%= javascript_include_tag 'deface/jquery-1.4.4.min.js', 'deface/jquery.qtip-1.0.0-rc3.min.js' %>
<%= javascript_tag do %>
  var $jQ = jQuery.noConflict(true);

  var overrides_by_hook = new Array();

  <% Theme.active.each do |theme| %>
    <%- theme.view_overrides.group_by(&:selector).each do |override| -%>
      overrides_by_hook['<%= override[0].gsub("'", "") %>'] = <%= override[1].size %>;
    <%- end -%>
  <% end %>

  $jQ(function(){
    if(top.Deface!=undefined){
      top.location = "/deface#templates/<%=params[:controller]%>/<%=params[:action]%>";
    }
  });
<% end %>
<%= javascript_include_tag 'deface/hooks.deface.js' %>
<% Theme.active.each do |theme| %>
  <% theme.stylesheets.each do |stylesheet| %>
    <style id="<%= stylesheet.id %>">
      <%= stylesheet.css %>
    </style>
  <% end %>
<% end %>
<style>
  .deface_hook_frame {
    outline: 2px solid #505050;
  }

  #deface_hook_bar{
    margin: -1px 0 0 -3px;
    background-color: blue;
    color: #fff;
    font-size: 8pt;
    position: absolute;
    top: 0;
    padding: 5px;
  }

  #deface_hook_bar a{
    text-decoration: none;
  }

  .deface-clearfix:after {
    clear:both;
    content:".";
    display:block;
    height:0;
    line-height:0;
    visibility:hidden;
  }

  .deface-qtip  h4{
    color: #fff;
    font-family: lucida Grande;
    font-size: 1.2em;
    margin-bottom: 4px;
  }

  .deface-qtip a, .deface-qtip a:visited, .deface-qtip a:hover{
    color: #fff;
    font-family: lucida Grande;
    font-size: 1.2em;
  }

  div.deface_source{
    display: none;
  }
</style>
